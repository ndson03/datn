<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Notification Fragment</title>
    <head th:replace="fragments/head :: common-head"></head>
</head>
<body>

<!-- Notification Fragment definition -->
<div th:fragment="notifications">
    <!-- Notification Icon with Badge -->
    <div class="notification-icon dropdown" id="notificationDropdown">
        <a class="nav-link text-light position-relative" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="fas fa-bell"></i>
            <span class="notification-badge" th:if="${unreadNotificationsCount > 0}" th:text="${unreadNotificationsCount}"></span>
        </a>

        <!-- Notification Dropdown Menu -->
        <div class="dropdown-menu dropdown-menu-end notification-dropdown p-0" aria-labelledby="notificationDropdown">
            <div class="notification-header">
                <h6 class="mb-0">Thông báo</h6>
                <a href="#" class="small text-decoration-none" th:if="${notifications != null && !notifications.empty}"
                   th:onclick="'markAllNotificationsAsRead(' + ${student.id} + '); return false;'">Đánh dấu đã đọc tất cả</a>
            </div>

            <div class="notification-body">
                <!-- If there are notifications -->
                <div th:if="${notifications != null && !notifications.empty}">
                    <div class="notification-item" th:each="notification : ${notifications}"
                         th:classappend="${notification.read ? '' : 'unread'}"
                         th:onclick="'viewNotification(' + ${notification.id} + ', ' + ${student.id} + '); return false;'">
                        <div class="d-flex justify-content-between align-items-start mb-1">
                            <h6 class="mb-0" th:classappend="${notification.read ? '' : 'fw-bold'}" th:text="${notification.title}"></h6>
                            <span class="notification-time" th:text="${notification.timeAgo}"></span>
                        </div>
                        <p class="mb-0 small" th:text="${notification.message}"></p>
                    </div>
                </div>

                <!-- If there are no notifications -->
                <div th:if="${notifications == null || notifications.empty}" class="empty-notifications">
                    <i class="fas fa-bell-slash"></i>
                    <p class="mb-0">Bạn không có thông báo nào</p>
                </div>
            </div>

            <div class="notification-footer">
                <a th:href="@{/student/{studentId}/notifications(studentId=${student.id})}" class="text-decoration-none">Xem tất cả thông báo</a>
            </div>
        </div>
    </div>
</div>

</body>
</html>