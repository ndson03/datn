	<!DOCTYPE html>
	<html lang="vi" xmlns:th="http://www.thymeleaf.org">
	<head>
		<title>Assignment Details</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="icon" type="image/png" th:href="@{/images/favicon.png}">
		<!-- Bootstrap 5 CSS -->
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
		<!-- Font Awesome 6 -->
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
		<!-- Material Design Icons -->
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@7.0.96/css/materialdesignicons.min.css">
		<!-- Google Fonts -->
		<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
		<!-- Custom CSS -->
		<link rel="stylesheet" th:href="@{/css/layout.css}">
		<style>
			/* Existing styles */

			/* Additional styles for file submission */
			.file-upload-container {
				background-color: #f8f9fa;
				border-radius: 8px;
				padding: 20px;
				margin-bottom: 20px;
				border: 1px dashed #ced4da;
			}

			.file-upload-title {
				font-weight: 500;
				margin-bottom: 15px;
			}

			.file-list {
				margin-top: 20px;
			}

			.file-item {
				background-color: #fff;
				border: 1px solid #e9ecef;
				border-radius: 6px;
				padding: 12px;
				margin-bottom: 10px;
				display: flex;
				justify-content: space-between;
				align-items: center;
			}

			.file-info {
				display: flex;
				align-items: center;
			}

			.file-icon {
				margin-right: 10px;
				font-size: 20px;
				color: #0d6efd;
			}

			.file-name {
				font-weight: 500;
				margin-bottom: 5px;
			}

			.file-meta {
				font-size: 12px;
				color: #6c757d;
			}

			.file-actions {
				display: flex;
				gap: 10px;
			}

			.file-comment {
				margin-top: 8px;
				font-style: italic;
				color: #495057;
				background-color: #f8f9fa;
				padding: 5px 10px;
				border-radius: 4px;
				border-left: 3px solid #0d6efd;
			}

			/* New styles for improved UI */
			.assignment-action-btn {
				padding: 12px 24px;
				font-weight: 500;
				transition: all 0.3s ease;
			}

			.quiz-btn {
				background-color: #6610f2;
				border-color: #6610f2;
			}

			.quiz-btn:hover {
				background-color: #520dc2;
				border-color: #520dc2;
			}

			.submit-file-btn {
				background-color: #0d6efd;
				border-color: #0d6efd;
				display: flex;
				align-items: center;
				justify-content: center;
			}

			.submit-file-btn:hover {
				background-color: #0b5ed7;
				border-color: #0a58ca;
			}

			.file-submission-form {
				margin-top: 20px;
				padding-top: 20px;
				border-top: 1px solid #dee2e6;
			}

			.assignment-actions {
				display: flex;
				flex-direction: column;
				align-items: center;
				margin: 2rem 0;
			}

			.assignment-status {
				padding: 12px 16px;
				border-radius: 8px;
				margin-bottom: 20px;
				display: flex;
				align-items: center;
			}

			.assignment-status i {
				font-size: 1.25rem;
				margin-right: 10px;
			}

			.submission-heading {
				display: flex;
				align-items: center;
				margin-bottom: 1rem;
			}

			.submission-heading i {
				margin-right: 10px;
				color: #0d6efd;
			}

			.action-btn-container {
				text-align: center;
				margin: 1.5rem 0;
			}

			.edit-mode {
				border: 2px solid #0d6efd;
				background-color: #f0f7ff;
			}

			.quiz-result-card {
				border-left: 4px solid #6610f2;
			}

			.file-edit-form {
				background-color: #f8f9fa;
				border-radius: 8px;
				padding: 15px;
				margin-top: 10px;
				border: 1px solid #dee2e6;
			}
		</style>
	</head>

	<body>
	<!-- Top Navbar -->
	<nav class="navbar navbar-expand-lg top-navbar navbar-dark fixed-top">
		<div class="container-fluid">
			<a class="navbar-brand d-flex align-items-center" th:href="@{/student/{studentId}/courses(studentId=${student.id})}">
				<i class="fas fa-graduation-cap me-2"></i>
				<span>Trường SICT - HaUI</span>
			</a>

			<button class="navbar-toggler" type="button" id="mobileToggle">
				<span class="navbar-toggler-icon"></span>
			</button>

			<div class="collapse navbar-collapse" id="navbarSupportedContent">
				<ul class="navbar-nav ms-auto">
					<li class="nav-item dropdown user-dropdown">
						<a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="navbarDropdown" role="button"
						   data-bs-toggle="dropdown">
							<div class="avatar me-2">
								<span th:text="${#strings.substring(student.firstName, 0, 1) + #strings.substring(student.lastName, 0, 1)}"></span>
							</div>
							<span th:text="${student.firstName + ' ' + student.lastName}"></span>
						</a>
						<ul class="dropdown-menu dropdown-menu-end">
							<li><a class="dropdown-item" href="#"><i class="fas fa-user me-2"></i> Hồ sơ</a></li>
							<li><a class="dropdown-item" href="#"><i class="fas fa-cog me-2"></i> Cài đặt</a></li>
							<li><hr class="dropdown-divider"></li>
							<li>
								<form action="#" th:action="@{/logout}" method="POST">
									<button type="submit" class="dropdown-item"><i class="fas fa-sign-out-alt me-2"></i> Đăng xuất</button>
								</form>
							</li>
						</ul>
					</li>
				</ul>
			</div>
		</div>
	</nav>

	<!-- Sidebar Toggle Button -->
	<button class="sidebar-toggle" id="sidebarToggle">
		<i class="fas fa-chevron-left"></i>
	</button>

	<!-- Side Navbar -->
	<nav class="side-navbar" id="sideNav">
		<div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist">
			<a class="nav-link" th:href="@{/student/{studentId}/courses(studentId=${student.id})}" title="Dashboard">
				<i class="fas fa-tachometer-alt"></i>
				<span>Dashboard</span>
			</a>
			<a class="nav-link" th:href="@{/student/{studentId}/chatbot(studentId=${student.id})}" title="Chatbot">
				<i class="fas fa-robot"></i>
				<span>Chatbot</span>
			</a>

			<div class="mt-3 px-3">
				<div class="small text-muted text-uppercase">Khóa học</div>
				<hr class="my-2">
			</div>

			<div th:each="course : ${courses}">
				<a class="nav-link"
				   th:href="@{/student/{studentId}/courses/{courseId}(studentId=${student.id}, courseId=${course.id})}"
				   th:title="${course.name}"
				   th:classappend="${course.id == courseId ? 'active' : ''}">
					<i class="fas fa-book"></i>
					<span th:text="${course.name}"></span>
				</a>
			</div>
		</div>
	</nav>

	<!-- Main Content -->
	<div class="main-content" id="mainContent">
		<div class="container-fluid">
			<!-- Assignment Header -->
			<div class="d-flex justify-content-between align-items-center mb-4">
				<h2 class="fw-bold">Chi tiết bài tập</h2>
				<nav aria-label="breadcrumb">
					<ol class="breadcrumb mb-0">
						<li class="breadcrumb-item"><a th:href="@{/student/{studentId}/courses(studentId=${student.id})}">Home</a></li>
						<li class="breadcrumb-item"><a th:href="@{/student/{studentId}/courses/{courseId}(studentId=${student.id}, courseId=${course.id})}">Khóa học</a></li>
						<li class="breadcrumb-item active" aria-current="page" th:text="${assignment.name}"></li>
					</ol>
				</nav>
			</div>

			<!-- Assignment Section -->
			<div class="card mb-4">
				<div class="card-header bg-light">
					<h5 class="mb-0 fw-bold">
						<i class="fas fa-tasks me-2"></i>
						<span th:text="${assignment.name}"></span>
					</h5>
				</div>
				<div class="card-body">
					<!-- Alert messages for file operations -->
					<div th:if="${message}" class="alert" th:classappend="${alertClass}" role="alert">
						<span th:text="${message}"></span>
						<button type="button" class="btn-close float-end" data-bs-dismiss="alert" aria-label="Close"></button>
					</div>

					<!-- Assignment Details Section -->
					<div class="assignment-details mb-4">
						<div class="row">
							<div class="col-md-6">
								<h6 class="text-muted mb-2">Thông tin bài tập</h6>
								<table class="table table-sm">
									<tbody>
									<tr>
										<td><i class="fas fa-book-open me-2"></i>Loại bài tập:</td>
										<td><span class="badge" th:classappend="${assignment.isQuiz() ? 'bg-info' : 'bg-primary'}" th:text="${assignment.isQuiz() ? 'Quiz' : 'Bài tập'}"></span></td>
									</tr>
									<tr>
										<td><i class="fas fa-calendar-check me-2"></i>Hạn nộp:</td>
										<td th:text="${assignment.dueDate != null ? assignment.dueDate : 'N/A'}"></td>
									</tr>
									</tbody>
								</table>
							</div>
							<div class="col-md-6">
								<h6 class="text-muted mb-2">Trạng thái</h6>
								<div class="assignment-status" th:classappend="${assignmentDetails != null && assignmentDetails.isDone == 1 ? 'bg-success text-white' : 'bg-warning text-dark'}">
									<i class="fas" th:classappend="${assignmentDetails != null && assignmentDetails.isDone == 1 ? 'fa-check-circle' : 'fa-clock'}"></i>
									<span th:text="${assignmentDetails != null && assignmentDetails.isDone == 1 ? 'Đã hoàn thành' : 'Đang thực hiện'}"></span>
								</div>
								<div th:if="${assignmentDetails != null && assignmentDetails.startTime != null}">
									<small class="text-muted">
										Bắt đầu làm lúc: <span th:text="${#temporals.format(assignmentDetails.startTime, 'dd/MM/yyyy HH:mm')}"></span>
									</small>
								</div>
							</div>
						</div>

						<!-- Assignment Description -->
						<div class="assignment-description mt-4">
							<h6 class="text-muted mb-2">Mô tả bài tập</h6>
							<div class="p-3 bg-light rounded">
								<p th:text="${assignment.description ?: 'Không có mô tả cho bài tập này.'}"></p>
							</div>
						</div>
					</div>

					<!-- Assignment Actions Section -->
					<div class="assignment-actions">
						<!-- If assignment has not been started yet -->
						<div th:if="${assignmentDetails == null || assignmentDetails.startTime == null}" class="text-center">
							<p class="mb-4">Nhấp vào nút bên dưới để bắt đầu làm bài.</p>
							<a class="btn btn-primary assignment-action-btn" th:href="@{/student/{studentId}/courses/{courseId}/lessonId/{lessonId}/assignments/{assignmentId}/start(studentId=${student.id}, courseId=${course.id}, lessonId=${lesson.Id}assignmentId=${assignment.id})}">
								<i class="fas fa-play-circle me-2"></i>Bắt đầu làm bài
							</a>
						</div>

						<!-- If assignment is in progress -->
						<div th:if="${assignmentDetails != null && assignmentDetails.startTime != null && assignmentDetails.isDone == 0}" class="w-100">
							<!-- For Quiz assignments -->
							<div th:if="${assignment.isQuiz()}" class="text-center mb-4">
								<a th:href="@{/student/{studentId}/courses/{courseId}/assignments/{assignmentId}/quiz/take(studentId=${student.id}, courseId=${course.id}, assignmentId=${assignment.id})}"
								   class="btn btn-primary btn-lg quiz-btn assignment-action-btn">
									<i class="fas fa-edit me-2"></i>Làm Quiz
								</a>
							</div>

							<!-- For regular assignments with file submission -->
							<div th:if="${!assignment.isQuiz()}" class="mb-4">
								<!-- File submission section - always visible now -->
								<div class="file-upload-container">
									<h5 class="submission-heading">
										<i class="fas fa-cloud-upload-alt"></i>Nộp file bài tập
									</h5>

									<form th:action="@{/student/{studentId}/courses/{courseId}/assignments/{assignmentId}/submit-file(studentId=${student.id}, courseId=${course.id}, assignmentId=${assignment.id})}"
										  method="post" enctype="multipart/form-data">

										<div class="mb-3">
											<label for="file" class="form-label">Chọn file từ máy tính của bạn:</label>
											<input type="file" class="form-control" id="file" name="file" required>
											<div class="form-text">Hỗ trợ các file: .pdf, .doc, .docx, .xls, .xlsx, .zip, .rar (Max: 10MB)</div>
										</div>

										<div class="mb-3">
											<label for="comment" class="form-label">Ghi chú (tùy chọn):</label>
											<textarea class="form-control" id="comment" name="comment" rows="3" placeholder="Nhập ghi chú về bài nộp của bạn..."></textarea>
										</div>

										<div class="d-flex justify-content-end">
											<button type="submit" class="btn btn-success">
												<i class="fas fa-paper-plane me-2"></i>Nộp bài
											</button>
										</div>
									</form>
								</div>

								<!-- List of submitted files -->
								<div class="file-list" th:if="${assignmentFileSubmissions != null && !assignmentFileSubmissions.isEmpty()}">
									<h5 class="submission-heading">
										<i class="fas fa-file-alt"></i>Các file đã nộp
									</h5>

									<div class="file-item" th:each="file : ${assignmentFileSubmissions}" th:id="'file-item-' + ${file.id}">
										<div class="file-info">
											<div class="file-icon">
												<i class="fas" th:classappend="${
													file.contentType.contains('pdf') ? 'fa-file-pdf' :
													file.contentType.contains('word') ? 'fa-file-word' :
													file.contentType.contains('excel') || file.contentType.contains('spreadsheet') ? 'fa-file-excel' :
													file.contentType.contains('zip') || file.contentType.contains('rar') ? 'fa-file-archive' :
													file.contentType.contains('image') ? 'fa-file-image' : 'fa-file'
												}"></i>
											</div>
											<div>
												<div class="file-name" th:text="${file.originalFileName}"></div>
												<div class="file-meta">
													<span th:text="${#numbers.formatDecimal(file.fileSize / 1024, 0, 'COMMA', 2, 'POINT')} + ' KB'"></span> •
													<span th:text="${file.uploadDate != null ? #temporals.format(file.uploadDate, 'dd/MM/yyyy HH:mm') : 'N/A'}"></span>
												</div>
												<div class="file-comment" th:if="${file.submissionComment != null && !file.submissionComment.isEmpty()}">
													<i class="fas fa-comment-alt me-1"></i>
													<span th:text="${file.submissionComment}"></span>
												</div>
											</div>
										</div>
										<div class="file-actions">
											<a th:href="@{/student/{studentId}/courses/{courseId}/assignments/{assignmentId}/download-file/{fileId}(studentId=${student.id}, courseId=${course.id}, assignmentId=${assignment.id}, fileId=${file.id})}"
											   class="btn btn-sm btn-outline-primary" title="Download">
												<i class="fas fa-download"></i>
											</a>
											<button type="button" class="btn btn-sm btn-outline-secondary edit-file-btn" th:data-file-id="${file.id}" title="Edit">
												<i class="fas fa-edit"></i>
											</button>
											<a th:href="@{/student/{studentId}/courses/{courseId}/assignments/{assignmentId}/delete-file/{fileId}(studentId=${student.id}, courseId=${course.id}, assignmentId=${assignment.id}, fileId=${file.id})}"
											   class="btn btn-sm btn-outline-danger"
											   onclick="return confirm('Bạn có chắc chắn muốn xóa file này?');"
											   title="Delete">
												<i class="fas fa-trash"></i>
											</a>
										</div>

										<!-- Edit form (hidden by default) -->
										<div class="file-edit-form w-100 mt-2" style="display:none;" th:id="'edit-form-' + ${file.id}">
											<form th:action="@{/student/{studentId}/courses/{courseId}/assignments/{assignmentId}/update-file/{fileId}(studentId=${student.id}, courseId=${course.id}, assignmentId=${assignment.id}, fileId=${file.id})}"
												  method="post" enctype="multipart/form-data">
												<div class="mb-3">
													<label class="form-label">Thay thế file:</label>
													<input type="file" class="form-control" name="updatedFile">
													<div class="form-text">Để trống nếu không muốn thay đổi file</div>
												</div>
												<div class="mb-3">
													<label class="form-label">Cập nhật ghi chú:</label>
													<textarea class="form-control" name="updatedComment" rows="2" th:text="${file.submissionComment}"></textarea>
												</div>
												<div class="d-flex justify-content-end">
													<button type="button" class="btn btn-sm btn-outline-secondary me-2 cancel-edit-btn" th:data-file-id="${file.id}">
														<i class="fas fa-times me-1"></i>Hủy
													</button>
													<button type="submit" class="btn btn-sm btn-success">
														<i class="fas fa-save me-1"></i>Lưu thay đổi
													</button>
												</div>
											</form>
										</div>
									</div>
								</div>

								<!-- If no files have been submitted yet -->
								<div class="alert alert-warning" th:if="${assignmentFileSubmissions == null || assignmentFileSubmissions.isEmpty()}">
									<i class="fas fa-exclamation-triangle me-2"></i>
									Bạn chưa nộp file nào cho bài tập này.
								</div>

								<!-- Mark as completed button -->
								<div class="text-center mt-4">
									<hr>
									<p class="mb-3">Hoặc nếu bạn đã hoàn thành bài tập theo cách khác:</p>
									<a class="btn btn-success" th:href="@{/student/{studentId}/courses/{courseId}/markAsCompleted/{assignmentId}(studentId=${student.id}, courseId=${course.id}, assignmentId=${assignmentDetails.getAssignmentId()})}"
									   onclick="if (!(confirm('Bạn có chắc chắn muốn đánh dấu bài tập này là đã hoàn thành?'))) return false">
										<i class="fas fa-check-circle me-2"></i>Đánh dấu đã hoàn thành
									</a>
								</div>
							</div>
						</div>

						<!-- If assignment is completed -->
						<div th:if="${assignmentDetails != null && assignmentDetails.isDone == 1}" class="w-100">
							<div class="alert alert-success">
								<i class="fas fa-check-circle me-2"></i>
								<strong>Bài tập đã hoàn thành!</strong> Bạn đã hoàn thành bài tập này.
							</div>

							<!-- Display quiz result if applicable -->
							<div th:if="${assignment.isQuiz() && existingSubmission != null}" class="mt-4">
								<div class="card quiz-result-card">
									<div class="card-header bg-light">
										<h5 class="mb-0 fw-bold"><i class="fas fa-poll me-2"></i>Kết quả Quiz</h5>
									</div>
									<div class="card-body">
										<div class="row">
											<div class="col-md-6">
												<h6 class="mb-3">Thông tin chi tiết</h6>
												<ul class="list-group">
													<li class="list-group-item d-flex justify-content-between align-items-center">
														Điểm số
														<span class="badge bg-primary rounded-pill" th:text="${score}"></span>
													</li>
													<li class="list-group-item d-flex justify-content-between align-items-center">
														Thời gian hoàn thành
														<span th:text="${endTime != null ? #dates.format(endTime, 'dd/MM/yyyy HH:mm') : 'N/A'}"></span>
													</li>
												</ul>
											</div>
											<div class="col-md-6 d-flex align-items-center justify-content-center">
												<a th:href="@{/student/{studentId}/courses/{courseId}/assignments/{assignmentId}/quiz/result(studentId=${student.id}, courseId=${course.id}, assignmentId=${assignment.id})}"
												   class="btn btn-primary btn-lg">
													<i class="fas fa-eye me-2"></i>Xem chi tiết bài làm
												</a>
											</div>
										</div>
									</div>
								</div>
							</div>

							<!-- Display submitted files for regular assignments -->
							<div th:if="${!assignment.isQuiz()}" class="mt-4">
								<div class="card">
									<div class="card-header bg-light">
										<h5 class="mb-0 fw-bold"><i class="fas fa-file-alt me-2"></i>File bài tập đã nộp</h5>
									</div>
									<div class="card-body">
										<!-- If files have been submitted -->
										<div th:if="${assignmentFileSubmissions != null && !assignmentFileSubmissions.isEmpty()}">
											<div class="file-item" th:each="file : ${assignmentFileSubmissions}" th:id="'file-item-' + ${file.id}">
												<div class="file-info">
													<div class="file-icon">
														<i class="fas" th:classappend="${
															file.contentType.contains('pdf') ? 'fa-file-pdf' :
															file.contentType.contains('word') ? 'fa-file-word' :
															file.contentType.contains('excel') || file.contentType.contains('spreadsheet') ? 'fa-file-excel' :
															file.contentType.contains('zip') || file.contentType.contains('rar') ? 'fa-file-archive' :
															file.contentType.contains('image') ? 'fa-file-image' : 'fa-file'
														}"></i>
													</div>
													<div>
														<div class="file-name" th:text="${file.originalFileName}"></div>
														<div class="file-meta">
															<span th:text="${#numbers.formatDecimal(file.fileSize / 1024, 0, 'COMMA', 2, 'POINT')} + ' KB'"></span> •
															<span th:text="${file.uploadDate != null ? #temporals.format(file.uploadDate, 'dd/MM/yyyy HH:mm') : 'N/A'}"></span>
														</div>
														<div class="file-comment" th:if="${file.submissionComment != null && !file.submissionComment.isEmpty()}">
															<i class="fas fa-comment-alt me-1"></i>
															<span th:text="${file.submissionComment}"></span>
														</div>
													</div>
												</div>
												<div class="file-actions">
													<a th:href="@{/student/{studentId}/courses/{courseId}/assignments/{assignmentId}/download-file/{fileId}(studentId=${student.id}, courseId=${course.id}, assignmentId=${assignment.id}, fileId=${file.id})}"
													   class="btn btn-sm btn-outline-primary" title="Download">
														<i class="fas fa-download"></i>
													</a>
													<button type="button" class="btn btn-sm btn-outline-secondary edit-file-btn" th:data-file-id="${file.id}" title="Edit">
														<i class="fas fa-edit"></i>
													</button>
													<a th:href="@{/student/{studentId}/courses/{courseId}/assignments/{assignmentId}/delete-file/{fileId}(studentId=${student.id}, courseId=${course.id}, assignmentId=${assignment.id}, fileId=${file.id})}"
													   class="btn btn-sm btn-outline-danger"
													   onclick="return confirm('Bạn có chắc chắn muốn xóa file này?');"
													   title="Delete">
														<i class="fas fa-trash"></i>
													</a>
												</div>

												<!-- Edit form (hidden by default) -->
												<div class="file-edit-form w-100 mt-2" style="display:none;" th:id="'edit-form-' + ${file.id}">
													<form th:action="@{/student/{studentId}/courses/{courseId}/assignments/{assignmentId}/update-file/{fileId}(studentId=${student.id}, courseId=${course.id}, assignmentId=${assignment.id}, fileId=${file.id})}"
														  method="post" enctype="multipart/form-data">
														<div class="mb-3">
															<label class="form-label">Thay thế file:</label>
															<input type="file" class="form-control" name="updatedFile">
															<div class="form-text">Để trống nếu không muốn thay đổi file</div>
														</div>
														<div class="mb-3">
															<label class="form-label">Cập nhật ghi chú:</label>
															<textarea class="form-control" name="updatedComment" rows="2" th:text="${file.submissionComment}"></textarea>
														</div>
														<div class="d-flex justify-content-end">
															<button type="button" class="btn btn-sm btn-outline-secondary me-2 cancel-edit-btn" th:data-file-id="${file.id}">
																<i class="fas fa-times me-1"></i>Hủy
															</button>
															<button type="submit" class="btn btn-sm btn-success">
																<i class="fas fa-save me-1"></i>Lưu thay đổi
															</button>
														</div>
													</form>
												</div>
											</div>
										</div>

										<!-- If no files have been submitted -->
										<div class="alert alert-warning" th:if="${assignmentFileSubmissions == null || assignmentFileSubmissions.isEmpty()}">
											<i class="fas fa-exclamation-triangle me-2"></i>
											Không có file nào được nộp cho bài tập này.
										</div>

										<!-- Add new file section -->
										<div class="card mt-4">
											<div class="card-header bg-light">
												<h5 class="mb-0"><i class="fas fa-plus-circle me-2"></i>Thêm file mới</h5>
											</div>
											<div class="card-body">
												<form th:action="@{/student/{studentId}/courses/{courseId}/assignments/{assignmentId}/submit-file(studentId=${student.id}, courseId=${course.id}, assignmentId=${assignment.id})}"
													  method="post" enctype="multipart/form-data">
													<div class="mb-3">
														<label for="additionalFile" class="form-label">Chọn file từ máy tính của bạn:</label>
														<input type="file" class="form-control" id="additionalFile" name="file" required>
														<div class="form-text">Hỗ trợ các file: .pdf, .doc, .docx, .xls, .xlsx, .zip, .rar (Max: 10MB)</div>
													</div>
													<div class="mb-3">
														<label for="additionalComment" class="form-label">Ghi chú (tùy chọn):</label>
														<textarea class="form-control" id="additionalComment" name="comment" rows="3" placeholder="Nhập ghi chú về bài nộp của bạn..."></textarea>
													</div>
													<div class="d-flex justify-content-end">
														<button type="submit" class="btn btn-primary">
															<i class="fas fa-plus me-2"></i>Thêm file
														</button>
													</div>
												</form>
											</div>
										</div>
									</div>

									<!-- Nút nộp lại bài tập -->
									<div class="text-center mt-4">
										<a th:href="@{/student/{studentId}/courses/{courseId}/assignments/{assignmentId}/resubmit(studentId=${student.id}, courseId=${course.id}, assignmentId=${assignment.id})}"
										   class="btn btn-outline-primary">
											<i class="fas fa-redo me-2"></i>Nộp lại bài tập
										</a>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	</div>

	<!-- Bootstrap JS and Popper.js -->
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>

	<script>
		document.addEventListener('DOMContentLoaded', function() {
			// Sidebar toggle functionality
			const sidebarToggle = document.getElementById('sidebarToggle');
			const mobileToggle = document.getElementById('mobileToggle');
			const sideNav = document.getElementById('sideNav');
			const mainContent = document.getElementById('mainContent');

			// Desktop toggle
			sidebarToggle.addEventListener('click', function() {
				sideNav.classList.toggle('collapsed');
				mainContent.classList.toggle('expanded');
				sidebarToggle.classList.toggle('collapsed');

				// Change icon direction
				const icon = sidebarToggle.querySelector('i');
				if (icon.classList.contains('fa-chevron-left')) {
					icon.classList.remove('fa-chevron-left');
					icon.classList.add('fa-chevron-right');
				} else {
					icon.classList.remove('fa-chevron-right');
					icon.classList.add('fa-chevron-left');
				}
			});

			// Mobile toggle
			mobileToggle.addEventListener('click', function() {
				sideNav.classList.toggle('show');
			});

			// Close sidebar when clicking outside on mobile
			document.addEventListener('click', function(event) {
				const isClickInsideSidebar = sideNav.contains(event.target);
				const isClickOnToggle = mobileToggle.contains(event.target);

				if (!isClickInsideSidebar && !isClickOnToggle && window.innerWidth < 992 && sideNav.classList.contains('show')) {
					sideNav.classList.remove('show');
				}
			});

			// Handle window resize
			window.addEventListener('resize', function() {
				if (window.innerWidth >= 992) {
					sideNav.classList.remove('show');
				}
			});

			// File edit functionality
			const editButtons = document.querySelectorAll('.edit-file-btn');
			const cancelButtons = document.querySelectorAll('.cancel-edit-btn');

			// Add click event for each edit button
			editButtons.forEach(btn => {
				btn.addEventListener('click', function() {
					const fileId = this.getAttribute('data-file-id');
					const fileItem = document.getElementById('file-item-' + fileId);
					const editForm = document.getElementById('edit-form-' + fileId);

					// Toggle edit form visibility
					if (editForm.style.display === 'none' || editForm.style.display === '') {
						editForm.style.display = 'block';
						fileItem.classList.add('edit-mode');
						this.innerHTML = '<i class="fas fa-times"></i>';
						this.title = 'Cancel';
					} else {
						editForm.style.display = 'none';
						fileItem.classList.remove('edit-mode');
						this.innerHTML = '<i class="fas fa-edit"></i>';
						this.title = 'Edit';
					}
				});
			});

			// Add click event for each cancel button
			cancelButtons.forEach(btn => {
				btn.addEventListener('click', function() {
					const fileId = this.getAttribute('data-file-id');
					const fileItem = document.getElementById('file-item-' + fileId);
					const editForm = document.getElementById('edit-form-' + fileId);
					const editButton = fileItem.querySelector('.edit-file-btn');

					// Hide edit form
					editForm.style.display = 'none';
					fileItem.classList.remove('edit-mode');
					editButton.innerHTML = '<i class="fas fa-edit"></i>';
					editButton.title = 'Edit';
				});
			});
		});
	</script>
	</body>
	</html>