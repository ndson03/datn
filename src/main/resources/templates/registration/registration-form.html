<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
	<title>Đăng ký - Trường SICT - HaUI</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="icon" type="image/png" th:href="@{/images/favicon.png}">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
	<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
	<style>
		:root {
			--primary-color: #0d6efd;
			--secondary-color: #6c757d;
			--light-color: #f8f9fa;
			--dark-color: #212529;
		}

		body {
			font-family: 'Roboto', sans-serif;
			background-color: #f5f7fa;
			display: flex;
			flex-direction: column;
			min-height: 100vh;
		}

		.register-container {
			max-width: 550px;
			margin: 0 auto;
			padding: 2rem;
			background-color: white;
			border-radius: 12px;
			box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
		}

		.brand-header {
			text-align: center;
			margin-bottom: 1.5rem;
		}

		.brand-logo {
			font-size: 2.5rem;
			color: var(--primary-color);
			margin-bottom: 0.5rem;
		}

		.brand-name {
			font-size: 1.5rem;
			font-weight: 700;
			color: var(--dark-color);
			margin-bottom: 0.25rem;
		}

		.brand-tagline {
			font-size: 0.9rem;
			color: var(--secondary-color);
		}

		.form-title {
			text-align: center;
			margin-bottom: 1rem;
			font-weight: 500;
			color: var(--dark-color);
		}

		.form-subtitle {
			text-align: center;
			margin-bottom: 1.5rem;
			color: var(--secondary-color);
			font-size: 0.9rem;
		}

		.form-control, .form-select {
			padding: 0.75rem;
			border-radius: 8px;
			border: 1px solid #ced4da;
		}

		.form-control:focus, .form-select:focus {
			box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.15);
		}

		.input-group-text {
			background-color: white;
			border-right: none;
		}

		.input-group .form-control {
			border-left: none;
		}

		.form-icon {
			position: absolute;
			left: 15px;
			top: 43px;
			color: var(--secondary-color);
			z-index: 10;
		}

		.form-group {
			margin-bottom: 1.25rem;
			position: relative;
		}

		.form-group label {
			font-size: 0.9rem;
			font-weight: 500;
			margin-bottom: 0.5rem;
			display: block;
		}

		.input-with-icon {
			padding-left: 2.5rem;
		}

		.btn-register {
			padding: 0.75rem;
			border-radius: 8px;
			font-weight: 500;
			width: 100%;
			margin-top: 0.5rem;
		}

		.error-feedback {
			color: #dc3545;
			font-size: 0.8rem;
			margin-top: 0.3rem;
		}

		.registration-error {
			font-size: 0.9rem;
			padding: 0.75rem;
			margin-bottom: 1.5rem;
			border-radius: 8px;
		}

		.footer {
			margin-top: auto;
			padding: 1.5rem 0;
			text-align: center;
			font-size: 0.85rem;
		}

		@media (max-width: 576px) {
			.register-container {
				margin: 1rem;
				padding: 1.5rem;
			}

			.row {
				margin-left: -5px;
				margin-right: -5px;
			}

			.col-md-6 {
				padding-left: 5px;
				padding-right: 5px;
			}
		}
	</style>
</head>

<body>
<div class="container my-4 d-flex flex-column flex-grow-1">
	<div class="row justify-content-center my-auto">
		<div class="col-12 col-lg-10">
			<div class="register-container">
				<!-- Brand Identity -->
				<div class="brand-header">
					<div class="brand-logo">
						<i class="fas fa-graduation-cap"></i>
					</div>
					<div class="brand-name">Trường SICT - HaUI</div>
					<div class="brand-tagline">Hệ thống quản lý học tập</div>
				</div>

				<h4 class="form-title">Đăng ký</h4>
				<p class="form-subtitle">Tạo tài khoản mới để truy cập hệ thống</p>

				<!-- Registration Error -->
				<div class="alert alert-danger registration-error" th:if="${registrationError}" th:text="${registrationError}"></div>

				<!-- Registration Form -->
				<form th:action="@{/register/processRegistrationForm}" th:object="${userDto}" method="POST">
					<!-- Username -->
					<div class="form-group">
						<label for="userName">Tên người dùng</label>
						<i class="fas fa-user form-icon"></i>
						<input type="text" class="form-control input-with-icon" id="userName" th:field="*{userName}" placeholder="Nhập tên người dùng" autofocus>
						<div class="error-feedback" th:if="${#fields.hasErrors('userName')}" th:errors="*{userName}">Invalid user name!</div>
					</div>

					<!-- Password and Confirm Password - in a row -->
					<div class="row">
						<div class="col-md-6">
							<div class="form-group">
								<label for="password">Mật khẩu</label>
								<i class="fas fa-lock form-icon"></i>
								<input type="password" class="form-control input-with-icon" id="password" th:field="*{password}" placeholder="Nhập mật khẩu">
								<div class="error-feedback" th:if="${#fields.hasErrors('password')}" th:errors="*{password}">Invalid password!</div>
							</div>
						</div>
						<div class="col-md-6">
							<div class="form-group">
								<label for="confirmPassword">Xác nhận mật khẩu</label>
								<i class="fas fa-lock form-icon"></i>
								<input type="password" class="form-control input-with-icon" id="confirmPassword" name="confirmPassword" placeholder="Nhập lại mật khẩu">
								<div class="error-feedback" id="password-mismatch" style="display: none;">Mật khẩu không khớp!</div>
							</div>
						</div>
					</div>

					<!-- Name Fields in One Row -->
					<div class="row">
						<div class="col-md-6">
							<div class="form-group">
								<label for="firstName">Họ đệm</label>
								<i class="fas fa-id-card form-icon"></i>
								<input type="text" class="form-control input-with-icon" id="firstName" th:field="*{firstName}" placeholder="Họ đệm">
								<div class="error-feedback" th:if="${#fields.hasErrors('firstName')}" th:errors="*{firstName}">Invalid first name!</div>
							</div>
						</div>
						<div class="col-md-6">
							<div class="form-group">
								<label for="lastName">Tên</label>
								<i class="fas fa-id-card form-icon"></i>
								<input type="text" class="form-control input-with-icon" id="lastName" th:field="*{lastName}" placeholder="Tên">
								<div class="error-feedback" th:if="${#fields.hasErrors('lastName')}" th:errors="*{lastName}">Invalid last name!</div>
							</div>
						</div>
					</div>

					<!-- Email -->
					<div class="form-group">
						<label for="email">Email</label>
						<i class="fas fa-envelope form-icon"></i>
						<input type="email" class="form-control input-with-icon" id="email" th:field="*{email}" placeholder="Nhập email">
						<div class="error-feedback" th:if="${#fields.hasErrors('email')}" th:errors="*{email}">Invalid email!</div>
					</div>

					<!-- Role -->
					<div class="form-group mb-4">
						<label for="role">Vai trò</label>
						<i class="fas fa-user-tag form-icon"></i>
						<select class="form-select input-with-icon" id="role" th:name="role">
							<option th:value="'ROLE_STUDENT'" th:text="'Sinh viên'"></option>
							<option th:value="'ROLE_TEACHER'" th:text="'Giảng viên'"></option>
						</select>
					</div>

					<!-- Register Button -->
					<button type="submit" class="btn btn-primary btn-register" id="registerBtn">
						<i class="fas fa-user-plus me-2"></i>Đăng ký
					</button>
				</form>

				<!-- Login Link -->
				<div class="text-center mt-4">
					<p class="mb-0">
						Bạn đã có tài khoản?
						<a th:href="@{/showLoginPage}" class="link-primary text-decoration-none">Đăng nhập</a>
					</p>
				</div>
			</div>
		</div>
	</div>
</div>

<!-- Footer -->
<footer class="footer">
	<div class="container">
		<p class="mb-0 text-muted">&copy; 2025 Trường SICT - HaUI. All rights reserved.</p>
	</div>
</footer>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- Password Validation Script -->
<script>
	document.addEventListener('DOMContentLoaded', function() {
		const passwordInput = document.getElementById('password');
		const confirmPasswordInput = document.getElementById('confirmPassword');
		const passwordMismatch = document.getElementById('password-mismatch');
		const registerBtn = document.getElementById('registerBtn');

		// Function to check password match
		function checkPasswordMatch() {
			if (confirmPasswordInput.value === '') {
				passwordMismatch.style.display = 'none';
				return;
			}

			if (passwordInput.value !== confirmPasswordInput.value) {
				passwordMismatch.style.display = 'block';
				registerBtn.disabled = true;
			} else {
				passwordMismatch.style.display = 'none';
				registerBtn.disabled = false;
			}
		}

		// Add event listeners
		passwordInput.addEventListener('input', checkPasswordMatch);
		confirmPasswordInput.addEventListener('input', checkPasswordMatch);

		// Form submission validation
		document.querySelector('form').addEventListener('submit', function(e) {
			if (passwordInput.value !== confirmPasswordInput.value) {
				e.preventDefault();
				passwordMismatch.style.display = 'block';
				confirmPasswordInput.focus();
			}
		});
	});
</script>
</body>
</html>